<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UHE Teles Pires - Monitor de Gera√ß√£o</title>
    <link rel="stylesheet" href="styles.css">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
    <!-- SheetJS -->
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
</head>
<body>
    <div class="container">
        <!-- Cabe√ßalho -->
        <header class="header">
            <h1 id="pageTitle">UHE Teles Pires - COI-GT - Desempenho da Gera√ß√£o</h1>
            <div class="header-actions no-print">
                <button id="uploadBtn" class="btn btn-primary">üìÇ Carregar data.xlsx</button>
                <button id="downloadTemplateBtn" class="btn btn-secondary">‚¨áÔ∏è Download data.xlsx</button>
                <button id="printBtn" class="btn btn-success">üñ®Ô∏è Imprimir Relat√≥rio</button>
                <input type="file" id="fileInput" accept=".xlsx,.xls" style="display: none;">
            </div>
        </header>

        <!-- KPIs -->
        <div class="kpi-grid">
            <div class="kpi-card kpi-purple">
                <div class="kpi-icon">üìä</div>
                <div class="kpi-content">
                    <div class="kpi-label">Desvio M√©dio</div>
                    <div class="kpi-value" id="desvioMedio">-- MW</div>
                </div>
            </div>
            <div class="kpi-card kpi-green">
                <div class="kpi-icon">‚ö°</div>
                <div class="kpi-content">
                    <div class="kpi-label">Pico de Gera√ß√£o</div>
                    <div class="kpi-value" id="picoGeracao">-- MW</div>
                    <div class="kpi-subtitle" id="picoHorario">--:--</div>
                </div>
            </div>
            <div class="kpi-card kpi-blue">
                <div class="kpi-icon">‚úì</div>
                <div class="kpi-content">
                    <div class="kpi-label">Efici√™ncia</div>
                    <div class="kpi-value" id="eficiencia">--%</div>
                    <div class="kpi-subtitle">Dentro da faixa ¬±50MW</div>
                </div>
            </div>
        </div>

        <!-- Gr√°fico Principal -->
        <div class="card">
            <h2>Gera√ß√£o vs Programado</h2>
            <canvas id="mainChart"></canvas>
        </div>

        <!-- Heatmap de Desvios -->
        <div class="card">
            <h2>Heatmap de Desvios</h2>
            <div class="heatmap-legend">
                üü¢ Dentro do Programado | üü° Desvio Moderado | üî¥ Desvio Alto
            </div>
            <div id="heatmap" class="heatmap-grid"></div>
        </div>

        <!-- Tabela Resumo Estat√≠stico -->
        <div class="card">
            <h2>Resumo Estat√≠stico por Per√≠odo</h2>
            <table class="stats-table">
                <thead>
                    <tr>
                        <th>Per√≠odo</th>
                        <th>Gera√ß√£o M√©dia (MW)</th>
                        <th>PDP M√©dio (MW)</th>
                        <th>Desvio M√©dio (MW)</th>
                    </tr>
                </thead>
                <tbody id="statsTableBody">
                    <tr>
                        <td>Madrugada (00h-06h)</td>
                        <td>--</td>
                        <td>--</td>
                        <td>--</td>
                    </tr>
                    <tr>
                        <td>Manh√£ (06h-12h)</td>
                        <td>--</td>
                        <td>--</td>
                        <td>--</td>
                    </tr>
                    <tr>
                        <td>Tarde (12h-18h)</td>
                        <td>--</td>
                        <td>--</td>
                        <td>--</td>
                    </tr>
                    <tr>
                        <td>Noite (18h-00h)</td>
                        <td>--</td>
                        <td>--</td>
                        <td>--</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Sistema de Observa√ß√µes -->
        <div class="card">
            <div class="observations-header">
                <h2>Observa√ß√µes <span id="obsCount" class="obs-count">(0)</span></h2>
                <div class="no-print">
                    <button id="uploadObsBtn" class="btn btn-sm btn-secondary">üìÇ Carregar Observa√ß√µes</button>
                    <button id="downloadObsBtn" class="btn btn-sm btn-secondary">‚¨áÔ∏è Download Observa√ß√µes</button>
                    <input type="file" id="obsFileInput" accept=".xlsx,.xls" style="display: none;">
                </div>
            </div>
            <div id="observationsList" class="observations-list"></div>
        </div>
    </div>

    <!-- Modal de Observa√ß√£o -->
    <div id="obsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">Adicionar Observa√ß√£o</h2>
                <button class="modal-close" id="closeModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>Hora:</label>
                    <input type="text" id="obsHora" readonly>
                </div>
                <div class="form-group">
                    <label>Gera√ß√£o (MW):</label>
                    <input type="text" id="obsGeracao" readonly>
                </div>
                <div class="form-group">
                    <label>PDP (MW):</label>
                    <input type="text" id="obsPdp" readonly>
                </div>
                <div class="form-group">
                    <label>Desvio (MW):</label>
                    <input type="text" id="obsDesvio" readonly>
                </div>
                <div class="form-group">
                    <label>Observa√ß√£o:</label>
                    <textarea id="obsTexto" rows="4" placeholder="Digite a observa√ß√£o..."></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button id="cancelObsBtn" class="btn btn-secondary">Cancelar</button>
                <button id="saveObsBtn" class="btn btn-primary">Salvar</button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
